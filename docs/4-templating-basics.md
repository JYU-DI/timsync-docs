---
title: Templating basics
---

{{#*inline "page"}}

# Templating basics

TIMSync supports static templating using Handlebars syntax.  
This page outlines the minimal basics of using Handlebars
and specific TIMSync extensions.

By default, all file types that are processed by TIMSync support 
static templating.

For a more complete Handlebars tutorial, please refer
to the [full language guide](https://handlebarsjs.com/guide/).

## Basic syntax

{{{{raw}}}}

### Expressions and values

In Handlebars, template expressions are surrounded between
double curly braces (`{{ ... }}`).

All values defined in the front matter of the file
are available in templates. For example, the following Markdown file

```md
---
first_name: Tom
last_name: Sawyer
---

{{first_name}} {{last_name}}
```

will produce the following final TIM document:


```md
Tom Sawyer
```

### Nested values

Handlebars supports nested values (that is, values that contain
more values) using the dot syntax. For example, the above example
can be rewritten as:

```md
---
person:
  first_name: Tom
  last_name: Sawyer
---

{{person.first_name}} {{person.last_name}}
```

### Helpers

Expressions can be modified using *helpers* that work like functions.
For example, TIMSync provides a helper named `to_upper_case` that
converts the first expression to upper case:

```md
---
fist_name: Tom
---

HELLO, {{to_upper_caser first_name}}!
```

The above code produces the following document:

```md
HELLO, TOM!
```

Note that in Handlebars, the parameters are separated by space.

Expressions can be nested together by using parentheses:

```md
---
first_name: "    tom    "
---

Hello, {{to_title_case (trim first_name)}}
```

The above example will first apply the `trim` helper (removes extra spaces)
and then abbly the `to_title_case` (make the first letter capital).
The final result will be

```md
Hello, Tom
```

### Block helpers (`if`, `each`, etc.)

Common control flows (conditionals, loops) are supported as *block helpers*.
Block helpers allow specifying templates as variables.
For example, the `if` block helper implements a conditional block:

```md
---
name: Tom
greet: true
---

{{#if greet}}
Hello, {{name}}!
{{else}}
Goodbye, {{name}}!
{{/if}}
```
{{{{/raw}}}}

{{#> note.md}}

Unlike in some templating languages, Handlebars **does not support
arithmetic or logical expressions** inside expressions.
For example, {{{{raw}}}} `{{#if value < 1}}` {{{{/raw}}}} will not work,
and neither will {{{{raw}}}} `{{value + 1}}` {{{{/raw}}}}.

For the for former case, TIMSync defines logical helpers, such as
`eq`, `ne`, `gt`, `gte`, `lt`, `lte`, `and`, `or`, `not` and `len`. For example, {{{{raw}}}} `{{#if (lt value 1)}}` {{{{/raw}}}} is equivalent to checking that `value < 1`.

For the latter case, you can write custom helpers using the Rhai scripting language, which provides more versatility. For more information, refer to the [scripting guide](./7-scripting.md).

{{/note.md}}


{{{{raw}}}}

To iterate over objects, you may use the `each` helper.
Note that in Handlebars, using each will change the *context* of the
template to be the current iterated item.
For example, consider the following document:


```md
---
persons:
  - first_name: Tom
    last_name: Sawyer
  - first_name: Huckleberry
    last_name: Finn
---

Persons:
{{#each persons}}
- {{first_name}} {{last_name}}
{{/each}}
```

Note that inside the `{{#each}}`, we directly use the expressions `first_name` and `last_name`, which will refer to the person that the helper is iterating.

If this seems confusing, consider using `{{#each ... as |...|}}`
expression which will instead bind each iterated item
to a value:

```md
---
persons:
  - first_name: Tom
    last_name: Sawyer
  - first_name: Huckleberry
    last_name: Finn
---

Persons:
{{#each persons as |person|}}
- {{person.first_name}} {{person.last_name}}
{{/each}}
```

{{{{/raw}}}}

## Built-in variables

TIMSync provides various built-in variables to simplify templating.
The variables are generally available in all documents for templating.

### Per-file variables

Each file receives the following unique variables:

- `title`: The title of the current document.
- `path`: The path of the document in TIM relative to the base path of the sync target.
- `doc_id`: The final document ID of the TIM document.
- Any values defined in the front matter

### Global variables

The following variables are shared between all documents:

- `site.host`: Hostname of the current sync target.
- `site.base_path`: The target base path of the current sync target.
- `site.local_project_dir`: File path to the current project folder on the local computer.
- `site.docs`: A list of all documents that will be generated by TIMSync. Each document object contains the same `title`, `path`, `doc_id` and front matter variables as the per-file variables.
- `site.doc`: A map of documents tagged by their UID. Each document contains the same `title`, `path`, `doc_id` and front matter variables as the per-file variables. This can be used to e.g., find out the TIM path of a file easily as follows{{{{raw}}}}:  
    
    home.md  

    ```md
    ---
    uid: homepage
    ---

    This is the home page!
    ```

    document.md  

    ```md
    [Go to home page](/view/{{ site.base_path }}/{{ site.doc.homepage.path }})
    ```
    {{{{/raw}}}}
- `site.style_themes`: A map of all the style file paths defined by their file name (without file extension).
- `site.*`: Any value defined in `_config.yml` is available via the `site.` prefix.


## Built-in helpers

TIMSync defines additional built-in helpers to simplify use of TIM and help with templating.

Overall, the following helpers are defined:

- `area`: a block helper that can be used to define areas. Areas can be used to reference text in other documents or to define collapsible text areas. Usage example{{{{raw}}}}:

    ```md
    {{#area}}
    An unnamed area. The area is given a random ID name.
    {{/area}}

    {{#area "example-area"}}
    A anmed area. Can be used for styling or for referencing the contents in another document.
    {{/area}}

    {{#area collapse=true}}
    **Collapsed area title. Clicking the title shows the contents.** 
    {{else}}
    Contents of the collapsed area.
    {{#area}}
    ```
    {{{{/raw}}}}

- `docsettings`: a block helper that can be used to define document settings in YAML format. This is just syntax sugar over the normal way to define document settings. Usage example{{{{raw}}}}:

    ```md
    {{#docsettings}}
    themes:
        - dia-mini
        - {{ site.style_themes.main }}
    {{/docsettings}}
    ```
    {{{{/raw}}}}

- `ref_area`: an inline helper that can be used to reference an area by its name. Example{{{{raw}}}}:

    doc1.md

    ```md
    ---
    uid: doc1
    ---
    {{#area "example-area"}}
    This is an area.
    {{/area}}
    ```

    doc2.md

    ```md
    {{ref_area site.doc.doc1.doc_id "example-area"}}
    ```

    Note that you must specify both document ID and area name.
    {{{{/raw}}}}

- `task`: Import a task by its UID. Example{{{{raw}}}}:

    my_task.task.yml

    ```yml
    ---
    uid: my_task
    plugin: csPlugin
    ---
    type: text
    ```

    doc.md

    ```md
    {{task "my_task"}}
    ```
    {{{{/raw}}}}

In addition, TIMSync imports the various helpers provided by the [`handlebars_misc_helpers`](https://github.com/davidB/handlebars_misc_helpers) crate. Specifically, the following helpers are available:

- [String transformation helpers](https://github.com/davidB/handlebars_misc_helpers/tree/master?tab=readme-ov-file#string-transformation)
- [JSON/YAML/TOML helpers](https://github.com/davidB/handlebars_misc_helpers/tree/master?tab=readme-ov-file#json--yaml--toml)
- [Path extraction helpers](https://github.com/davidB/handlebars_misc_helpers/tree/master?tab=readme-ov-file#path-extraction)
- [File helpers](https://github.com/davidB/handlebars_misc_helpers/tree/master?tab=readme-ov-file#file)
- [Environment variable helpers](https://github.com/davidB/handlebars_misc_helpers/tree/master?tab=readme-ov-file#environment-variable)
- [Assignment helper](https://github.com/davidB/handlebars_misc_helpers/tree/master?tab=readme-ov-file#assign-set)

## Templates, partials, layouts

TIMSync allows to define *template files* (also known as *partials*) that allow reusing the same
content across the project.

To define templates, create a `_templates` folder in the project root path.  
Any files added to the path can be used as partial templates.

For example, if you define the a file named `_templates/hello.md`:

```md
Hello, world!
```

{{{{raw}}}}
you can import it in any document using the `{{> partial_filename}}` syntax as follows:

```md
---
title: Some document
---

{{> hello.md}}
```

This will create the following document:

```md
Hello, world!
```

One useful way to use the block syntax to define partials with custom content.
For example, defining the following template named `_templates/note.md`:

`````md
```` {.huomautus atom="true"}
{{> @partial-block}}
````
`````

Allows to define note blocks in a semantically clear way:


```md
{{#> note.md}}

This is a note!

{{/note.md}}
```

{{{{/raw}}}}


### Example: Defining layouts

One main use for template files is to define layouts.
This can be achieved using partials and *inline partials*.

To define a layout, create a layout template inside `_templates` folder.
For example, consider the following `_templates/layout.md` file:

{{{{raw}}}}

```md
# {{title}}

***
**Abstract:**  
{{> abstract}}
***

{{> content}}
```

The imports `{{> abstract}}` and `{{> content}}` can be considered as *slots* into which
the main document can insert content.

The above layout can then be used in the main document as follows:

```md
---
title: My document
---

{{#*inline "abstract"}}
This is an abstract.
{{/inline}}

{{#*inline "content"}}
This is the main content.
{{/inline}}

{{> layout.md}}
```

This will produce the following TIM document:

```md
# My document

***
**Abstract:**  
This is an abstract.
***

This is the main content.
```

Note that any variables in the main document are available within the layout.

{{{{/raw}}}}

{{#> note.md}}

Currently, there is no support for simpler layout definitions. However, there are plans
to simplify defining and importing of layouts without the explicit use of inline partials.

{{/note.md}}

## Compatibility with TIM's own templating

The static templating provided with TIMSync are fully compatible.

Note that in TIM, Jinja2 is used as the templating language which has different syntax.

In genral, one may use Handlebars expressions within Jinja2 templates to
pass data between TIMSync and TIM. The main difference between the two is that TIM's Jinja2 templates can be evaluated dynamically based on the user who views the page.

**As a general rule**, try to use TIMSync's static templating whenever possible, as it will never incur any runtime cost when a user visits the page. **Whenever you need to change the contents depending on the user who views the page**, use TIM's Jinja2 templating instead.

A quick example of passing values between TIMSync and TIM:

{{{{raw}}}}
```md {nomacros="true"}
---
# Persons defined in front matter -> available in Handlebars expressions
persons:
  - first_name: Tom
    last_name: Sawyer
  - first_name: Huckleberry
    last_name: Finn
---

{{#docsettings}}
# Defining persons in TIM docsettings -> available in TIM Jinja2 templates
macros:
  persons: {{json_to_str persons}}
{{/docsettings}}

Persons is now available in TIM as a macro: %%persons%%

#- {nocache="true"}
Current user's username: %%username%%
```
{{{{/raw}}}}

{{/inline}}

{{> doc_layout.md}}